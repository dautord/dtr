EMPLOYEE DASHBOARD

- if leave balance is zero
	- insufficient leave balance for that type
		- DONE

- schedule call time change to varchar.

- comment out my information in the meantime
	- DONE
ADMIN DASHBOARD

	- remove time computation for datetime start and end. make no. of days, deduct that to balance
			- if halfday, -0.5
				- DONE 
			- change all leaves to decimal, not int 
				- DONE

- rename emp.no column to qr.no. and remove from display
- make new column in tbl_employee called emp. no -> varchar, shouldnt change because it is not called.
	
- include undertime, editable ng admin
	- include minutes late and minutes undertime

- make new leave without pay button, same as leave request but remove leave type 
	
PHASE 2 UPDATES:

- Employee Information and updates
	- Admin can enable/disable editing
- New button for Export to excel - generated (checks earliest time in and latest time out per day)
- Manage Buttons 

side quest:
- kita yung absent sa export to excel


TASK HISTORY / README:

04/03/23
-password page almost done, need success and error display messages

06/03/23
-password page done. 
-new dashboard shows number and type of leaves
-paternal if male, and maternal if female 
-fixed sidebar issue where the page you are on is not highlighted blue 

07/03/23
-added solo_parent_leave to the system, dashboard. 
-added solo parent leave to the dropdown menu in leave_request form 
-new form: leave_request.php
-new function: submitLeaveRequest() in class_model.php
-put asia manila timezone tom 

08/03/23
- asia manila timezone
- time field in form for leave_request.php (supposed to track date and time but only date shows up in form, with time 00:00:00)
- leave history for employee side delete button tom (dashboard.php)
then hard part is on friday/sat (admin approval) (if sick, sick_leave - 1, etc.)

09/03/23
- new function: cancelLeaveRequest() in class_model.php
- leave history cancel button finished, refreshing, but needs a confirmation message. 
the canceled request should be gone after the cancel confirmation message

10/03/23
- rows of leave history table in dashboard.php are 
highlighted light yellow if pending, light red if rejected, and light green if approved.
- cancel confirmation added to cancelling of leave request in table in dashboard.php.
- added word wrap to line break long sentence in reason column of leave request table in dashboard.php.
- changed order of available leaves in dashboard.php.

13/03/23 
- start renaming all of "DTR" to "CDBS HRMS" or "CDBS HR Management System"
- footer.php changed
- finished fixing random front-end matters, like sidebar, logout for employee dashboard, missing curly bracket in employee index.php

14/03/23
- fixed conditional statements in dropdown menu of leave_request.php
- added $department for vacation leave display in non-teaching employees (getEmployeeLeaves()) for dashboard.php and leave_request.php

15/03/23 
- adminGetLeaveRequests() on class_model.php
- Leave Requests on admin page 
- fixed data widget tree view for admin sidebar

16/03/23
- added leave limits per type of leave to tbl_department
- moved include of sidebar AFTER header so headers already sent error doesnt show up
- adminSetLeaveStatus()
- accept and reject buttons working, just need to -1 to type of leave - but before that, set values for limits first

17/03/23 
- added get and set functions for leave limits per department and front end in manage_department.php
	- getDepartmentLeaveLimits()
	- updateDepartmentLeaveLimits()
- changed footer for both admin and employee

21/03/23
- migrated to win 7 desktop
- edit_leave_limits.php 
- headers already sent FIX: bring include sidebar to AFTER header redirection
- changed qr code column to employee password in admin manage_employee.php

22/03/23
- setDepartmentLeaveBalances() and updateEmployeeLeaveBalance() TODO: refresh all employee balances according to dept. limit 
- to update ajax forms, following are needed:
	-manage_employee.php
	-employee_row.php
	-editemployee_modal.php
	-edit_employee.php
	-edit_employee() in class_model.php
-lost to a comma today, but eventually fixed it so that you are able to set employee leaves individually. 
-just remembered: Employee ID numbers starting with 0 lose their 0 upon data edit. and then is unable to sign in with their original number. 
	- to prevent this, rename QR code img filename to one without 0

23/03/23
- Reset Employee Leave Balances button in manage_department.php
- setDepartmentLeaveBalances() and updateEmployeeLeaveBalance() in class_model.php
- trying to disable the leave request form button but not working
	- getLeaveButtonStatus() and toggleLeaveButtonStatus() in class_model.php
- TODO: disable leave request form button, calculate leave balance properly (3 days = -3) and how to assign leave type 

24/03/23
- finally able to set leave_button_status in database to 0. TODO: employee dashboard.php side
- added a redirect for leave_request.php to dashboard.php if $buttonStatus == 0
	- this is so that users who know how to modify url cannot access leave_request.php once it has been locked by the admin
- changed front end button of leave_request.php to look more like a button
- added ORDER BY datetime_requested for the leaves, so that the leave requests are arranged by most recent
- TODO: calculate leave balance with datetime start and datetime end, how to assign leave type

25/03/23
- tidied up front-end of various pages, so that it looks neat. 

27/03/23
- commented out Manage Schedules from admin panel as it is incomplete for now. 
- fetchAll_empAttendance() and fetchindividual_empAttendance() used to get attendance data table from database
	- fetchindividual_empAttendance() has joined qr_code from tbl_employee and tbl_attendance 
	- TODO: need to implement different attendance (work days and work hours) for different departments. 

28/03/23
- TIL: new vscode extensions extensively help in writing code
- added a new column in tbl_department called late_time type: time, not null
	- this is so that we can set the late time per department.
- updated the edit_department() function in class_model.php to include late_time parameter

- added admin functionality of setting the late_time per department, but input of "7:30:00" saves as "12:00:07" somehow in the database. 
	- 2:44 PM : fixed. now able to set according to input in modal, but "late_time" is just a value for now, no comparisons are being made in attendance.

- created a log_helper.php that creates a new file called my_log.txt everytime its function write_log is called. 
	- (e.g. write_log("Recieved Late Time: " . $formatted_late_time); - output in my_log.txt: 2023-03-28 08:31:38 - Recieved Late Time: 07:30:00)

29/03/23
- 2nd day of updating windows 10 pcs in windows lab, done with 04, 05, and 06 no issues. PCS that could not update: IT-01
- late_time of tbl_department should be referenced by attendance to check if late. TO DO: also make time out? 

01/04/23
- 3rd day of updating windows 10 pcs: 07, 08 and 09
- IT-09 only sees 21H2. might need more time. 07 and 08 are up to date.
	- IT-09 didnt finish updating.

03/04/23
- 4th day of updating win 10: continuing 09 while starting 10 and 11
- fixed minor issues like line breaks and spacing
- new function that joins tbl_attendance and tbl_employee on qrcode, tbl_employee and tbl_department on department name called fetchAll_empAttendance()

- finished different time ins for different departments
	- note: all attendances for an employee will be considered "late" if employee does not belong to a department.
	- note: since time in and time out does not consider the log date, it does not consider if the employee timed in in the afternoon. 
		- this results in employees being "on time" when they time in at around 4pm. oddly enough, 12:00 pm is late. 

04/04/23
- 5th day of updating win 10 pcs: 12, 13 and 14
- added a third condition to manage_attendance.php and attendance.php, where if the person has status == 0, the attendance is "invalid".
- came across a bug where people are late when they timed in at 12:59 PM, but some people are not late when they time in at 1:05 PM.
	- to test this, encoded everyone to a department with all departments late time being 7:30 am 
	- 1:00 PM to 7:30:00 AM is on time, while 7:30:01 AM to 12:59 PM is late.
	- finally fixed it. Late, Invalid, and On Time should be working as intended.
- renamed qrcode images that have the first number as 0 to one without that 0. e.g. 0513 -> 513

05/04/23
- 6th day of updating win 10 pcs: 15, 16, and 17
- fixed missing curly bracket in dtr_panel/index.php
- note: camera preview not showing in root/index.php

11/04/23
- 7th day of updating win 10 pcs: 18, 19, 20
- fixed uncaught reference error of startTime() in root index.php
- updated instascan.min.js to solve mismatch in assignment warning, but still no video preview. will do extra debugging at home
	- mentions of polyfill in instascan.min.js
- added dtr_system.sql (11/04/23) for git
- for this week, play the summer program ads on the tv if maraming tao sa main lobby, then ask tr. camille for the updated video next week.
- will buy notebook later for a physical copy of $this tasks.txt 

12/04/23
- 8th day of updating win 10 pcs: 21, 22, 23 and 24
- transfer of tasks and note taking on a physical copy notebook
- attended AM grad of G6 

13/04/23
- finishing win 10 updates of 21, 22, 23 and 24. -> finished, starting on 25, 26 and 27
- pull out of PCS in classrooms and transfer to new office 
	- note to self: bring extra shirt always
- return to using win 11 laptop for faster work productivity. will need to import most recent sql and git pull
	- do tom

17/04/23
- set up additional PCs for Windows Comp Lab. updated IT-28, 42, 33, 35. 
- need to get the two attendance pcs in the stock room of the gym
- front-end of set attendance days done in manage_attendance.php
	- update: done with backend, new column in tbl_department called work_week, varchar (255) 
	- new functions fetchAll_departmentName() and updateDepartmentWorkWeek()
	- new file called process_attendance.php which handles form submission of setting work days in manage_attendance.php.
	- TODO: employee side, show tbl_department late_time and work_week
- included dtr_system 17/04/23 version in git commit -> for migrating back to win 11 laptop

18/04/23
- in charge of comp lab, teachers are using it as a conference room -> make sure aircon is off during lunch break
- welcome video for scribbles and schemes early childhood center 
- front-end of employee side of setting schedules and workdays done in attendance.php
	- update: done with backend, new function fetchIndividualEmpDeptData() in class_model.php
	- employee now able to view their schedule, including their department, call time and work days.
- mxf to mp4 file conversions for tr. camille using movavi video converter 23

19/04/23
- started working on back-end of leave balance calculation based on the difference of datetime_end and datetime_start. 
	- function also makes use of leave_type in tbl_leave_request to determine what balance in tbl_employee to deduct from.
	- calculateEmpLeaveBalanceOnLeaveApproval() in class_model.php 
		- call this function on admin leave approval
		- update: ask sir Enrico if Aion uses days or hours for leave balance
			- how would this be calculated if half day, or whole.
- refactored code for class_model.php
- TODO: front-end, and finish leave calculation
- TODO: solutions for the Instascan.js video preview not showing

20/4/23 
- meeting with sir holy, updates and changes needed to be met by the time this system is presented to sir enrico.
- migrate back to win 11 laptop - export sql and git pull

- changed datetime_start and datetime_end to date format.
- changed all ints involving leave balances in the database to decimal (11,1).
- fixed calculateEmpLeaveBalanceOnLeaveApproval() based on num_of_days in tbl_leave_request
	- fixed submitLeaveRequest() and adminGetLeaveRequests() to handle the new column num_of_days in tbl_leave_request.
- now able to calculate employee leave balance on admin approval. 
- fixed the logic for leave_request.php so that it will prevent the user from sending a leave request with num_of_days > remainingBalance for that type.
